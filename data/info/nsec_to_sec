#!/usr/bin/python
"""
A simple script for the conversion from nanoseconds to seconds
in data files generated by rostopic echo -p.
"""

import argparse
import csv

def convert_to_secs(infile, outfile):
    """
    Converts the nanoseconds field of the timestamp in the
    input file and saves the output to the output file.
    """
    reader = csv.reader(infile, delimiter=',')
    writer = csv.writer(outfile)
    is_header = True
    for row in reader:
        if is_header:
            writer.writerow(row)
            is_header = False
        else:
            mod_row = row
            mod_row[0] = str(float(mod_row[0])/1e9)
            mod_row[2] = str(float(mod_row[2])/1e9)
            writer.writerow(mod_row)


if __name__ == "__main__":
  parser = argparse.ArgumentParser(
      description='Changes timestamps from nanoseconds to seconds.')
  parser.add_argument('infile', type=file, help='input csv file')
  parser.add_argument('outfile', type=argparse.FileType('w'), help='output csv file')
  args = parser.parse_args()
  convert_to_secs(args.infile, args.outfile)
 
